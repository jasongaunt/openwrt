// SPDX-License-Identifier: GPL-2.0-or-later OR MIT

#include "qcom-ipq4019.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include <dt-bindings/input/input.h>
#include <dt-bindings/input/linux-event-codes.h>
#include <dt-bindings/soc/qcom,tcsr.h>

/ {
	model = "Zyxel WSQ50";
	compatible = "zyxel,wsq50";

	chosen {
		/*
		 * the vendor u-boot adds root and mtdparts cmdline parameters
		 * which we don't want... but we have to overwrite them or else
		 * the kernel will take them at face value.
		 */
		bootargs-append = " clk_ignore_unused root=/dev/mmcblk0p8 mtdparts=spi0.0:0x60000@0x60000(0:QSEE)ro,0x80000@0xE0000(u-boot)ro,0x10000(env)ro,0x10000(0:ART)ro,0x10000(dualflag),0x10000(CRT)ro,0x260000(reserved)";
	};

	clocks {
		gcc_sleep_clk_src: gcc_sleep_clk_src {
			#clock-cells = <0x00>;
			clock-frequency = <0x7d00>;
			compatible = "fixed-clock";
		};
	};

	keys {
		compatible = "gpio-keys";

		reset {
			label = "reset";
			gpios = <&soc_gpios 0x12 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_RESTART>;
		};
	};

	sdhci@7824000 {
		bus-width = <0x08>;
		cd-gpios = <&soc_gpios 0x16 0x01>;
		// clock-names = "core", "iface";
		// clocks = <0x02 0x2e 0x02 0x2d>;
		compatible = "qcom,sdhci-msm-v4";
		// interrupts = <0x0 0x7b 0x00 0x00 0x8a 0x00>;
		// interrupt-parent = <&soc_gpios>;
		pinctrl-0 = <&sd_0_pins>;
		pinctrl-names = "default";
		reg = <0x7824900 0x11c 0x7824000 0x800>;
		// sd-ldo-gpios = <&soc_gpios 0x21 0x01>;
		// vqmmc-supply = <0x53>;
		status = "okay";
		non-removable;
	};

	blsp1_uart0: serial@78b0000 {
		compatible = "qcom,msm-uartdm-v1.4", "qcom,msm-uartdm";
		reg = <0x78b0000 0x200>;
		clock = <&gcc GCC_BLSP1_UART2_APPS_CLK>;
		bit-rate = <0xFF>;
		status = "disabled";
		u-boot,dm-pre-reloc;
	};

	blsp1_spi0: spi@78b6000 {
		compatible = "qcom,spi-qup-v2.2.1";
		reg = <0x78b6000 0x600>;
		clocks = <&gcc GCC_BLSP1_QUP2_SPI_APPS_CLK>;
		#address-cells = <1>;
		#size-cells = <0>;
		status = "disabled";
		u-boot,dm-pre-reloc;
	};

	watchdog@b017000 {
		clocks = <&gcc_sleep_clk_src>;
		compatible = "qcom,kpss-wdt-ipq40xx";
		// interrupt-names = "bark_irq";
		// interrupts = <0x00 0x03 0x00>;
		reg = <0xb017000 0x40>;
		status = "okay";
		timeout-sec = <0x0a>;
		wdt_bark_time = <0x10>;
		wdt_bite_time = <0x14>;
		wdt_en = <0x08>;
		wdt_res = <0x04>;
	};

	wifi@a000000 {
		core-id = <0x00>;
		compatible = "qca,wifi-ipq40xx";
		reg = <0xa000000 0x200000>;
	};

	wifi@a800000 {
		core-id = <0x01>;
		compatible = "qca,wifi-ipq40xx";
		reg = <0xa800000 0x200000>;
	};
};

&blsp1_spi1 {
	m25p80@0 {
		compatible = "jedec,spi-nor", "n25q128a11";
		spi-max-frequency = <24000000>;
		reg = <0x00>;

		partitions {
			compatible = "fixed-partitions";
			#address-cells = <1>;
			#size-cells = <1>;

			partition0@0 {
				label = "0:QSEE";
				reg = <0x00060000 0x00060000>;
				read-only;
			};
			partition1@E0000 {
				label = "u-boot";
				reg = <0x000E0000 0x00080000>;
				read-only;
			};
			partition2@160000 {
				label = "env";
				reg = <0x00160000 0x00010000>;
				read-only;
			};
			partition3@170000 {
				label = "0:ART";
				reg = <0x00170000 0x00010000>;
				read-only;
			};
			partition4@180000 {
				label = "dualflag";
				reg = <0x00180000 0x00010000>;
			};
			partition5@190000 {
				label = "CRT";
				reg = <0x00190000 0x00010000>;
				read-only;
			};
			partition6@1A0000 {
				label = "reserved";
				reg = <0x001A0000 0x00260000>;
			};
		};
	};
};

&soc_gpios {
	led_pins: led_pinmux {
		mux {
			output-high;
			bias-pull-up;
			drive-strength = <0x08>;
			pins = "gpio44", "gpio45", "gpio46";
		};
	};

	sd_0_pins: sd_0_pinmux {
		sd7 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio7";
			pins = "gpio32";
		};

		sd6 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio6";
			pins = "gpio31";
		};

		sd5 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio5";
			pins = "gpio30";
		};

		sd4 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio4";
			pins = "gpio29";
		};

		sdcmd {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio_cmd";
			pins = "gpio28";
		};

		sdclk {
			vm-enable;
			drive-type = <0x07>;
			pull-res = <0x02>;
			function = "sdio_clk";
			pins = "gpio27";
		};

		sd3 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio3";
			pins = "gpio26";
		};

		sd2 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio2";
			pins = "gpio25";
		};

		sd1 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio1";
			pins = "gpio24";
		};

		sd0 {
			vm-enable;
			drive-type = <0x01>;
			pull-res = <0x02>;
			function = "sdio0";
			pins = "gpio23";
		};
	};

	serial_pins: serial_pinmux {
		mux {
			pins = "gpio60", "gpio61";
			function = "blsp_uart0";
			bias-disable;
		};
	};

	spi_0_pins: spi-0-pinmux {
		pinmux {
			function = "blsp_spi0";
			pins = "gpio13", "gpio14", "gpio15";
			bias-disable;
		};

		pinmux_cs {
			function = "gpio";
			pins = "gpio12";
			bias-disable;
			output-high;
		};
	};


};
